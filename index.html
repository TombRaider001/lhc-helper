<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>六合彩推荐工具（抓取开奖数据）</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body { background: #f5f5f5; padding: 20px; }
    .card { box-shadow: 0 0 10px rgba(0,0,0,0.1); }
    .number-box {
      display: inline-block;
      width: 36px; height: 36px;
      line-height: 36px;
      text-align: center;
      background: #007bff;
      color: white;
      border-radius: 50%;
      margin: 2px;
      cursor: pointer;
    }
  </style>
</head>
<body>
<div class="container">
  <h2 class="mb-4">🎯 六合彩开奖 & 推荐工具</h2>

  <div class="card p-4 mb-4">
    <h5>📌 最近一期开奖号码（来自 pilio 网站）</h5>
    <button class="btn btn-primary btn-sm mb-3" onclick="loadPage()">点击获取</button>
    <div id="result" class="fs-5">等待获取数据...</div>
  </div>

  <div class="card p-4 mb-4">
    <h5>✨ 推荐号码</h5>
    <button class="btn btn-success btn-sm mb-2" onclick="recommend()">生成推荐</button>
    <div><strong>热号推荐：</strong><span id="hot"></span></div>
    <div><strong>冷热混合：</strong><span id="mix"></span></div>
    <div><strong>随机推荐：</strong><span id="rand"></span></div>
  </div>

  <div class="card p-4">
    <h5>📖 网站说明</h5>
    <p>本页面通过中转代理抓取 <code>pilio.idv.tw</code> 提供的六合彩开奖页面，并解析出最近一期的期号与开奖号码，并提供推荐组合。</p>
    <p>⚠️ 数据来自公开网页，仅供参考。</p>
  </div>
</div>

<script>
  let allNumbers = [];

  async function loadPage() {
    const output = document.getElementById('result');
    output.textContent = '加载中...';
    try {
      const proxy = 'https://api.allorigins.win/raw?url=' + encodeURIComponent('https://www.pilio.idv.tw/ltohk/list.asp');
      const res = await fetch(proxy);
      const html = await res.text();
      const parser = new DOMParser();
      const doc = parser.parseFromString(html, 'text/html');

      const rows = doc.querySelectorAll("table tr");
      allNumbers = [];
      for (let i = 0; i < 100; i++) {
        const row = rows[i];
        if (!row || row.querySelectorAll(".tdStyle1").length < 2) continue;
        const tds = row.querySelectorAll(".tdStyle1");
        const nums = tds[1].textContent.trim().split(/\D+/).filter(n => n);
        if (nums.length >= 6) allNumbers.push(nums.map(n => parseInt(n)));
      }

      const latest = allNumbers[0];
      const issue = doc.querySelector(".tdStyle1").textContent.trim();
      output.innerHTML = `<strong>期号：</strong> ${issue} <br><strong>开奖号码：</strong> ` +
        latest.map(n => `<span class="number-box">${n}</span>`).join('');
    } catch (e) {
      output.textContent = '获取失败，请稍后重试。';
    }
  }

  function recommend() {
    if (allNumbers.length === 0) {
      alert("请先获取开奖数据");
      return;
    }

    const freq = {};
    for (let i = 1; i <= 49; i++) freq[i] = 0;
    allNumbers.forEach(set => set.forEach(n => freq[n]++));

    const sorted = Object.entries(freq).sort((a,b) => b[1]-a[1]);
    const hot = sorted.slice(0,6).map(e=>parseInt(e[0]));
    const cold = sorted.slice(-6).map(e=>parseInt(e[0]));
    const mix = [...hot.slice(0,3), ...cold.slice(0,3)].sort((a,b)=>a-b);

    const rand = [];
    const pool = Array.from({length:49},(_,i)=>i+1);
    while(rand.length < 6) {
      const i = Math.floor(Math.random()*pool.length);
      rand.push(pool.splice(i,1)[0]);
    }

    document.getElementById("hot").innerHTML = hot.map(n => `<span class="number-box">${n}</span>`).join('');
    document.getElementById("mix").innerHTML = mix.map(n => `<span class="number-box">${n}</span>`).join('');
    document.getElementById("rand").innerHTML = rand.sort((a,b)=>a-b).map(n => `<span class="number-box">${n}</span>`).join('');
  }
</script>
</body>
</html>