<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>六合彩開獎 + 推薦工具</title>
  <style>
    body { font-family: Arial, sans-serif; background: #f4f4f4; padding: 20px; max-width:720px; margin:auto; }
    h1, h2 { text-align:center; }
    .card { background:white; padding:16px; border-radius:8px; margin:20px 0; box-shadow:0 0 10px rgba(0,0,0,0.1); }
    .btn { padding:10px 20px; background:#007BFF; color:#fff; border:none; border-radius:5px; cursor:pointer; margin:10px 0; }
    .btn-green { background:#28A745 }
    .ball { display:inline-block; width:36px;height:36px;line-height:36px;background:#2196F3;color:#fff;border-radius:50%;margin:4px; }
  </style>
</head>
<body>

  <h1>六合彩 開獎 & 推薦</h1>

  <div class="card">
    <h2>📌 最新開獎號碼</h2>
    <button class="btn" onclick="loadLatest()">點擊獲取</button>
    <div id="latest" style="margin-top:10px;">-- 尚未獲取 --</div>
  </div>

  <div class="card">
    <h2>✨ 推薦號碼</h2>
    <button class="btn-green" onclick="generate()">生成推薦</button>
    <div><strong>熱號：</strong><div id="hot"></div></div>
    <div><strong>冷熱混合：</strong><div id="mix"></div></div>
    <div><strong>隨機推薦：</strong><div id="random"></div></div>
  </div>

  <script>
    let historyNums = [];

    async function loadLatest(){
      const out = document.getElementById('latest');
      out.textContent = '加載中...';
      try {
        const proxy = 'https://corsproxy.io/?' + encodeURIComponent('https://www.pilio.idv.tw/ltohk/list.asp');
        const res = await fetch(proxy);
        const html = await res.text();

        const regex = /<font color="#0000ff" size="2"><b>(\d{2})<\/b><\/font><\/td>/g;
        const nums = [...html.matchAll(regex)].map(m => m[1]).slice(0,7);
        historyNums = nums; // 只用最新一期数据
        
        out.innerHTML = nums.map(n=>`<span class="ball">${n}</span>`).join(' ');
      } catch {
        out.textContent = '獲取失敗，請稍後重試';
      }
    }

    function generate(){
      if (historyNums.length < 7) return alert('請先獲取最新開獎號碼');
      const freq = {};
      historyNums.forEach(n=> freq[n] = (freq[n]||0)+1);
      for(let i=1;i<=49;i++){ const k=String(i).padStart(2,'0'); if(!freq[k]) freq[k]=0; }
      const sorted = Object.entries(freq).sort((a,b)=>b[1]-a[1]).map(e=>e[0]);
      const hot = sorted.slice(0,6);
      const cold = sorted.slice(-6);
      const mix = [...hot.slice(0,3),...cold.slice(0,3)];
      const rand=[];
      while(rand.length<6){
        let r = String(Math.floor(Math.random()*49+1)).padStart(2,'0');
        if(!rand.includes(r)) rand.push(r);
      }

      document.getElementById('hot').innerHTML = hot.map(n=>`<span class="ball">${n}</span>`).join(' ');
      document.getElementById('mix').innerHTML = mix.map(n=>`<span class="ball">${n}</span>`).join(' ');
      document.getElementById('random').innerHTML = rand.map(n=>`<span class="ball">${n}</span>`).join(' ');
    }
  </script>

</body>
</html>
