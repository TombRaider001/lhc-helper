<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8" />
  <title>六合彩推荐工具</title>
  <style>
    body {
      font-family: "Microsoft YaHei", sans-serif;
      background: #f9f9f9;
      padding: 20px;
      max-width: 600px;
      margin: auto;
    }
    h1 { color: #333; }
    h2 { margin-top: 30px; }
    .nums {
      font-size: 22px;
      margin: 10px 0;
      color: #222;
    }
    button {
      padding: 10px 20px;
      background: #007bff;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    button:hover { background: #0056b3; }
  </style>
</head>
<body>
  <h1>六合彩号码推荐工具</h1>

  <h2>🎯 最新开奖号码：</h2>
  <div class="nums" id="latestNums">加载中...</div>

  <h2>📊 推荐号码</h2>
  <button onclick="genAll()">生成推荐</button>
  <div class="nums"><strong>热号：</strong><span id="hot"></span></div>
  <div class="nums"><strong>冷热混合：</strong><span id="mix"></span></div>
  <div class="nums"><strong>随机推荐：</strong><span id="random"></span></div>

  <script>
    let historyData = [];

    async function fetchLatest() {
      try {
        const res = await fetch('https://hk.marksixapi.com/latest');
        const obj = await res.json();
        if (obj && obj.data && obj.data.nums) {
          document.getElementById('latestNums').textContent = obj.data.nums.join(' ');
        } else {
          document.getElementById('latestNums').textContent = '获取失败';
        }
      } catch (e) {
        document.getElementById('latestNums').textContent = '加载失败';
      }
    }

    async function fetchHistory() {
      try {
        const res = await fetch('https://hk.marksixapi.com/history?limit=100');
        const obj = await res.json();
        historyData = obj.data.map(e => e.nums.map(Number));
      } catch (e) {
        alert('历史数据获取失败');
      }
    }

    function calcFreq() {
      const freq = {};
      for (let i = 1; i <= 49; i++) freq[i] = 0;
      historyData.forEach(arr => arr.forEach(n => freq[n]++));
      const sorted = Object.entries(freq).sort((a, b) => b[1] - a[1]);
      const hot = sorted.slice(0, 6).map(e => +e[0]);
      const cold = sorted.slice(-6).map(e => +e[0]);
      return { hot, cold };
    }

    function genAll() {
      const { hot, cold } = calcFreq();
      document.getElementById('hot').textContent = hot.join(' ');
      const mix = [...hot.slice(0, 3), ...cold.slice(0, 3)].sort((a, b) => a - b);
      document.getElementById('mix').textContent = mix.join(' ');

      const pool = Array.from({ length: 49 }, (_, i) => i + 1);
      const rand = [];
      while (rand.length < 6) {
        const idx = Math.floor(Math.random() * pool.length);
        rand.push(pool.splice(idx, 1)[0]);
      }
      document.getElementById('random').textContent = rand.sort((a, b) => a - b).join(' ');
    }

    (async function () {
      await fetchHistory();
      await fetchLatest();
    })();
  </script>
</body>
</html>