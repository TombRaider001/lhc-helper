<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>六合彩開獎 & 推薦工具</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #f3f3f3;
      color: #222;
      padding: 20px;
      max-width: 720px;
      margin: auto;
    }
    h1 {
      text-align: center;
      color: #333;
    }
    .card {
      background: white;
      padding: 16px;
      border-radius: 8px;
      margin: 20px 0;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    .btn {
      padding: 8px 16px;
      background: #007bff;
      border: none;
      border-radius: 4px;
      color: white;
      cursor: pointer;
      margin: 6px 0;
    }
    .btn-green {
      background: #28a745;
    }
    .numbers {
      margin-top: 8px;
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }
    .ball {
      display: inline-block;
      padding: 10px 16px;
      background: #2196f3;
      color: white;
      border-radius: 50%;
      font-weight: bold;
    }
  </style>
</head>
<body>

<h1>🎯 六合彩開獎 & 推薦工具</h1>

<div class="card">
  <h3>📌 最近一期開獎號碼（來自 pilio 網站）</h3>
  <button class="btn" onclick="loadData()">點擊獲取</button>
  <div id="latestResult">尚未加載</div>
</div>

<div class="card">
  <h3>✨ 推薦號碼</h3>
  <button class="btn btn-green" onclick="generateRecommendations()">生成推薦</button>
  <div>
    熱號推薦：<div class="numbers" id="hot"></div>
    冷熱混合：<div class="numbers" id="mix"></div>
    隨機推薦：<div class="numbers" id="random"></div>
  </div>
</div>

<script>
const proxyURL = 'https://frosty-fire-4725.jonbaby1126.workers.dev';

async function loadData() {
  document.getElementById('latestResult').innerText = '加載中...';
  try {
    const res = await fetch(proxyURL);
    const html = await res.text();
    const numbers = [...html.matchAll(/\d{2}(?=<\/font><\/b><\/td>)/g)].map(m => m[0]).slice(0, 7);
    document.getElementById('latestResult').innerHTML = numbers.map(n => `<span class="ball">${n}</span>`).join(' ');
    window.allNumbers = extractAllNumbers(html);
  } catch (e) {
    document.getElementById('latestResult').innerText = '獲取失敗，請稍後重試。';
  }
}

function extractAllNumbers(html) {
  const matches = [...html.matchAll(/\d{2}(?=<\/font><\/b><\/td>)/g)].map(m => m[0]);
  return matches.slice(0, 100 * 7); // 100 期 x 7 號碼
}

function generateRecommendations() {
  if (!window.allNumbers || window.allNumbers.length < 7) {
    alert('請先加載最新開獎資料');
    return;
  }
  const freq = {};
  window.allNumbers.forEach(n => freq[n] = (freq[n] || 0) + 1);
  const sorted = Object.entries(freq).sort((a,b) => b[1]-a[1]).map(e => e[0]);
  const hot = sorted.slice(0, 6);
  const cold = sorted.slice(-6);
  const mix = [...hot.slice(0,3), ...cold.slice(0,3)];
  const rand = [];
  while(rand.length < 6) {
    const n = String(Math.floor(Math.random() * 49 + 1)).padStart(2, '0');
    if (!rand.includes(n)) rand.push(n);
  }
  document.getElementById('hot').innerHTML = hot.map(n => `<span class="ball">${n}</span>`).join(' ');
  document.getElementById('mix').innerHTML = mix.map(n => `<span class="ball">${n}</span>`).join(' ');
  document.getElementById('random').innerHTML = rand.map(n => `<span class="ball">${n}</span>`).join(' ');
}
</script>

</body>
</html>